{"componentChunkName":"component---src-templates-post-tsx","path":"/changes-to-packages-and-configs-in-laravel-5","result":{"data":{"allPost":{"edges":[{"node":{"id":"blog-post-fd82bcfc-0e56-5dd8-94be-f64a78092ee2","parent":null,"internal":{"mediaType":"text/html","type":"post","owner":"default-site-plugin","ignoreType":null,"fieldOwners":null,"description":null,"contentDigest":"2015-01-04T19:03:35-08:00","content":"I started a new project late in 2014 which I knew would be fertile ground to keep pace with the what's happening in Laravel 5. &nbsp;It's been a great learning experience merging in changes from the <a href=\"https://github.com/laravel/laravel/tree/develop\" target=\"_blank\">upstream Laravel project branch</a> as they happened.<br />\n<br />\nThe keen observer might have noticed however that Taylor made a <a href=\"https://github.com/laravel/framework/commit/3a0afc20f25ad3bed640ff1a14957f972d123cf7#diff-b8cefb9815a278c2c0aa3c91b2c3ec14\" target=\"_blank\">commit</a> on December 4th that \"broke\" support for packages designed to target Laravel 4.<br />\n<blockquote class=\"twitter-tweet\" lang=\"en\">\n<a href=\"https://twitter.com/Omega_\">@Omega_</a> ehhh maybe… i’ll see how it shakes out… need to finish that up next week<br />\n— Taylor Otwell (@taylorotwell) <a href=\"https://twitter.com/taylorotwell/status/550753989935906816\">January 1, 2015</a></blockquote>\n<br />\n<script async=\"\" charset=\"utf-8\" src=\"//platform.twitter.com/widgets.js\"></script>\n\nPatience is key, so I was happy to continue waiting for the <i>next great thing</i>.<br />\n<br />\nIn Laravel 4, packages allow their configurations to be overridden per environment. &nbsp;A package can ship a default configuration which can then be copied into the project as a template to be combined with the original's settings at runtime. &nbsp;Think of it as a really tricked out&nbsp;<a href=\"http://php.net/manual/en/function.array-merge-recursive.php\" target=\"_blank\">array_merge_recursive</a>.<br />\nBy removing <i><span style=\"font-family: Courier New, Courier, monospace;\">ServiceProvider::package</span></i>, what's being conveyed is that the automatic cascade behaviour is now deprecated.<br />\n<br />\nThis might seem distressing, but don't worry. &nbsp;Any behaviours you've created that might have depended on arrays are still good. &nbsp;It's just more deliberate - and luckily enough, a great discussion sparked up on twitter yesterday which helped clear a way forward.<br />\n<br />\n<i><span style=\"font-size: x-small;\">(<a href=\"https://twitter.com/Omega_/status/551538333583564800\" target=\"_blank\">I said it before</a>, but I'll say it again, I really appreciate Taylor's patience as I muddled through understanding the changes.)</span></i><br />\n<i><span style=\"font-size: x-small;\"><br /></span></i>\n<br />\n<blockquote class=\"twitter-tweet\" lang=\"en\">\n<a href=\"https://twitter.com/Omega_\">@Omega_</a> there is no publishing… Just override it in your app using config set… Just set it :)<br />\n— Taylor Otwell (@taylorotwell) <a href=\"https://twitter.com/taylorotwell/status/551544936831934464\">January 4, 2015</a></blockquote>\n<br />\n<script async=\"\" charset=\"utf-8\" src=\"//platform.twitter.com/widgets.js\"></script>\n\nI was a bit confused at this point, because I was expecting there to be some kind of magical mechanism between the package and the project still. &nbsp;Not realizing of course that rather than expecting the two to couple, you simply leverage your project's <span style=\"font-family: Courier New, Courier, monospace;\">ServiceProvider</span> to do any customizations. &nbsp;I had been creating project-level <span style=\"font-family: Courier New, Courier, monospace;\">ServiceProviders</span> in my Laravel 4 projects for a while now but more importantly:<br />\n<blockquote class=\"twitter-tweet\" data-conversation=\"none\" lang=\"en\">\n<a href=\"https://twitter.com/Omega_\">@Omega_</a> L4 config was wayyyyy overcomplicated and slow<br />\n— Taylor Otwell (@taylorotwell) <a href=\"https://twitter.com/taylorotwell/status/551531700111822848\">January 4, 2015</a></blockquote>\n<br />\n<script async=\"\" charset=\"utf-8\" src=\"//platform.twitter.com/widgets.js\"></script>\n\nThis really makes a lot of sense and while I didn't struggle with L4 configs, I'm sure I could see how they came off as a bit arcane to some. &nbsp;There are a few circumstances where I think people went a bit off the rails with trying to extend or modify the config systems. &nbsp;Those are their messes to own, but at least now it won't result in them mis-blaming the framework.<br />\n<br />\nOkay, so where does that leave us? &nbsp;Well, if you're still wondering how you can merge configs and simplify things, there's really just one tweet left in the discussion that helped me understand:<br />\n<blockquote class=\"twitter-tweet\" lang=\"en\">\n<a href=\"https://twitter.com/Omega_\">@Omega_</a> in package: Config::set… in project… Config::set...<br />\n— Taylor Otwell (@taylorotwell) <a href=\"https://twitter.com/taylorotwell/status/551557408518963202\">January 4, 2015</a></blockquote>\n<br />\n<script async=\"\" charset=\"utf-8\" src=\"//platform.twitter.com/widgets.js\"></script>\n\nThe simplest summary I can offer based on this is that instead of asking Laravel to load and combine configurations, you are now responsible for providing those arrays yourself. &nbsp;Fear not however, because you can still merge them conveniently using <a href=\"https://github.com/laravel/framework/blob/master/src/Illuminate/Config/Repository.php#L58\" target=\"_blank\"><span style=\"font-family: Courier New, Courier, monospace;\">Illuminate\\Config\\Repository::set</span></a>. &nbsp;The reader is encouraged to also look at the utility method <a href=\"https://github.com/laravel/framework/blob/master/src/Illuminate/Support/helpers.php#L274\" target=\"_blank\"><span style=\"font-family: Courier New, Courier, monospace;\">array_set</span></a> and <a href=\"https://github.com/laravel/framework/blob/master/src/Illuminate/Support/Arr.php#L329\" target=\"_blank\"><span style=\"font-family: Courier New, Courier, monospace;\">Arr::set</span></a>.<br />\nIf you're going to be parsing config for your pacakge, I'd suggest familiarizing yourself with <a href=\"https://github.com/laravel/framework/blob/master/src/Illuminate/Support/ServiceProvider.php#L37\" target=\"_blank\">ServiceProvider::register</a> and <a href=\"https://github.com/laravel/framework/blob/master/src/Illuminate/Support/ServiceProvider.php#L109\" target=\"_blank\">ServiceProvider::boot</a>. &nbsp;It's worth noting that boot is optional and supports method-injection from the framework. &nbsp;This explains why the method isn't present or marked as abstract in the parent.<br />\n<br />\nThey're run by the framework in order of <span style=\"font-family: Courier New, Courier, monospace;\">register</span> and then <span style=\"font-family: Courier New, Courier, monospace;\">boot</span>, so my understanding right now is that you'd do all your config parsing in register and then leverage that configuration in boot or closures.<br />\n<br />\n<h3>\nThoughts</h3>\nI'd encourage you not to see these changes as the loss of a feature, but an attempt to help you simplify your projects. &nbsp;There's been a great push to apply&nbsp;<a href=\"http://12factor.net/\" target=\"_blank\">12factor</a> practices in Laravel 5 - namely&nbsp;<a href=\"http://12factor.net/config\" target=\"_blank\">configuration and parameterizing</a> your applications. When you decide to dive into using Docker and other hosting setups, you'll be glad these sorts of things happened!<br />\n<br />\nIn terms of simplifying resource and configuration file loading - I think <a href=\"https://twitter.com/taylorotwell/status/551541738352177152\" target=\"_blank\">Taylor has something in mind. &nbsp;We simply have to be patient.</a><br />\n<br />\nHopefully this post has cleared things up for you. &nbsp;If I've missed anything or still have it wrong, let me know with a comment!"},"slug":"changes-to-packages-and-configs-in-laravel-5","title":"Changes to Packages and Configs in Laravel 5","created":"2015-01-04T17:22:00.000Z","updated":"2015-01-05T03:03:35.000Z"}}]}},"pageContext":{"slug":"changes-to-packages-and-configs-in-laravel-5"}},"staticQueryHashes":["3220165301"]}